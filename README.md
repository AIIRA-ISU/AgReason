# AgReason

AgReason is an open‑source benchmark and toolkit for evaluating and improving large reasoning models in agriculture. It provides:

* **AgReason Dataset**: 51.7K expert‑curated agronomy questions with detailed reasoning traces and ground‑truth answers.
* **AgThoughts Dataset**: 44.4K expert‑guided question–answer pairs generated by state‑of‑the‑art reasoning models.
* **AgThinker Models**: Fine‑tuned LLMs of various sizes trained on AgThoughts for enhanced agricultural reasoning.
* **Evaluation Toolkit**: Scripts to run the `LLM-as-a-judge` evaluation pipeline, compute precision/recall/F1, and generate benchmark reports.

---

## Features

* Expert‑verified open‑ended questions across 10 agronomic categories.
* Reference‑based, statement‑level evaluation using LLMs as judges.
* Support for multiple model backends (OpenAI, local checkpoints).
* Automatic generation of performance tables and plots.

---

## Installation

```bash
# Clone the repository
git clone https://github.com/baskargroup/AgReason.git
cd AgReason

# Create a virtual environment
python3 -m venv venv
source venv/bin/activate

# Install requirements
pip install -r requirements.txt
```

---

## Usage

### 1. Prepare API keys

Export your OpenAI or other LLM credentials:

```bash
export OPENAI_API_KEY="your_api_key"
```

### 2. Download datasets

```bash
python scripts/download_datasets.py --output data/
```

### 3. Run evaluation

```bash
python scripts/evaluate_models.py \
  --dataset data/agreason_benchmark.jsonl \
  --models "gemi2.5-flash,grok-3-beta,phi3_sft" \
  --output results/
```

This generates:

* `results/metrics.csv`: per‑model precision/recall/F1 and pass rates
* `results/plots/benchmark_all.pdf`: overall performance bar chart
* `results/plots/category_f1_radar.pdf`: category‑based radar plots

---

## Example

```python
from agreason import load_benchmark, evaluate

# Load benchmark questions
questions = load_benchmark("data/agreason_benchmark.jsonl")

# Evaluate a model (OpenAI GPT-4o)
metrics = evaluate(
    questions,
    model_name="gpt-4o",
    api_key=os.getenv("OPENAI_API_KEY"),
    threshold=0.75,
)

print(metrics)
# {'precision': 0.58, 'recall': 0.62, 'f1': 0.60, 'pass_rate': 0.42}
```

---

## Contributing

We welcome contributions! Please fork the repo, create a branch, and submit a pull request. To report issues or feature requests, file an issue on GitHub.

---

## License

This project is licensed under the MIT License. See [LICENSE](LICENSE) for details.

---

## Citation

If you use AgReason in your work, please cite:

```bibtex
@inproceedings{zare2025agreason,
  title={Towards Large Reasoning Models for Agriculture: Dataset and Benchmark},
  author={Zare Mehrjerdi, Hossein and et al.},
  booktitle={NeurIPS},
  year={2025}
}
```
